var base=$("#var-base").val();if(editormd.emoji={path:base+"/emojis/",ext:".png"},editormd.markdownToHTML("markdown-body",{markdown:$("#markdown-content").val(),path:base+"/js/markdown/lib/",htmlDecode:"style,script,iframe",tocm:!0,emoji:!0,taskList:!0,tex:!0,flowChart:!0,sequenceDiagram:!0}),$(".ui.embed").embed(),"true"===$("#var-editing-mode").val()){Dropzone.autoDiscover=!1;var editor=editormd("markdown-editor",{height:600,dialogLockScreen:!1,path:base+"/js/markdown/lib/",pluginPath:base+"/js/markdown/plugins/",htmlDecode:"style,script,iframe",tex:!0,emoji:!0,taskList:!0,flowChart:!0,sequenceDiagram:!0,imageUpload:!0,imageFormats:["jpg","jpeg","gif","png","doc","docx","xls","xlsx","ppt","pptx","txt","mp3","mp4","avi","wmv"],imageUploadURL:base+"/uploads?type=projects&removeAlpha=true"});$("[name=name]").on("input",function(){var e=$(this),a=e.closest("form"),o=getSlug(e.val());a.find("[name=slug]").val(o)}),$(".btn-save").click(function(){var a=$(this).closest("form");a.addClass("loading");var e=a.find("[name=id]").val(),o=a.find("[name=type]").val(),n=a.find("[name=cover]").val(),i=a.find("[name=name]").val(),t=a.find("[name=brief]").val(),r=a.find("[name=label]").val(),s=a.find("[name=responsibilities]").val(),l=a.find("[name=from-month]").val(),m=a.find("[name=from-year]").val(),d=a.find("[name=to-month]").val(),c=a.find("[name=to-year]").val(),p=a.find("[name=technologies]").val(),f=a.find("[name=link]").val(),v=a.find("[name=highlights]").val(),h=a.find("[name=slug]").val(),g=a.find("[name=show-in-resume]").parent().checkbox("is checked"),u=a.find("[name=is-draft]").parent().checkbox("is checked"),b=editor.getMarkdown();$.post(base+"/projects/"+e,{name:i,type:o,cover:n,brief:t,label:r,responsibilities:s,fromMonth:l,fromYear:m,toMonth:d,toYear:c,technologies:p,link:f,highlights:v,content:b,slug:h,showInResume:g,isDraft:u}).done(function(e){window.location=base+"/projects/"+e.project.slug}).fail(function(e){a.removeClass("loading"),showFormError(a,getError(e))})}),$("#project-cover-dropzone").dropzone({url:base+"/uploads?type=projects",previewsContainer:"#project-cover-dropzone",maxFiles:1,init:function(){this.on("maxfilesexceeded",function(e){this.removeAllFiles(),this.addFile(e)}),this.on("success",function(e){var a=JSON.parse(e.xhr.response);$("[name=cover]").val(a.path),$("#project-cover-dropzone").attr("src",a.url+"?"+Date.now())})}})}