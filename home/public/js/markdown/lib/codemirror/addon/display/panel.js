!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function s(e,t,i,r){this.cm=e,this.node=t,this.options=i,this.height=r,this.cleared=!1}e.defineExtension("addPanel",function(e,t){this.state.panels||function(r){var e=r.getWrapperElement(),t=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,s=parseInt(t.height),n=r.state.panels={setHeight:e.style.height,heightLeft:s,panels:0,wrapper:document.createElement("div")};e.parentNode.insertBefore(n.wrapper,e);var i=r.hasFocus();n.wrapper.appendChild(e),i&&r.focus();r._setSize=r.setSize,null!=s&&(r.setSize=function(e,t){if(null==t)return this._setSize(e,t);if("number"!=typeof(n.setHeight=t)){var i=/^(\d+\.?\d*)px$/.exec(t);i?t=Number(i[1]):(n.wrapper.style.height=t,t=n.wrapper.offsetHeight,n.wrapper.style.height="")}r._setSize(e,n.heightLeft+=t-s),s=t})}(this);var i=this.state.panels;t&&"bottom"==t.position?i.wrapper.appendChild(e):i.wrapper.insertBefore(e,i.wrapper.firstChild);var r=t&&t.height||e.offsetHeight;return this._setSize(null,i.heightLeft-=r),i.panels++,new s(this,e,t,r)}),s.prototype.clear=function(){if(!this.cleared){this.cleared=!0;var e=this.cm.state.panels;this.cm._setSize(null,e.heightLeft+=this.height),e.wrapper.removeChild(this.node),0==--e.panels&&function(e){var t=e.state.panels;e.state.panels=null;var i=e.getWrapperElement();t.wrapper.parentNode.replaceChild(i,t.wrapper),i.style.height=t.setHeight,e.setSize=e._setSize,e.setSize()}(this.cm)}},s.prototype.changed=function(e){var t=null==e?this.node.offsetHeight:e,i=this.cm.state.panels;this.cm._setSize(null,i.height+=t-this.height),this.height=t}});