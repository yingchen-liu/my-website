!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(r){"use strict";function o(t){"object"==typeof t&&(this.minChars=t.minChars,this.style=t.style,this.showToken=t.showToken,this.delay=t.delay,this.wordsOnly=t.wordsOnly),null==this.style&&(this.style="matchhighlight"),null==this.minChars&&(this.minChars=2),null==this.delay&&(this.delay=100),null==this.wordsOnly&&(this.wordsOnly=!1),this.overlay=this.timeout=null}function l(t){var e=t.state.matchHighlighter;clearTimeout(e.timeout),e.timeout=setTimeout(function(){h(t)},e.delay)}function h(a){a.operation(function(){var t=a.state.matchHighlighter;if(t.overlay&&(a.removeOverlay(t.overlay),t.overlay=null),a.somethingSelected()||!t.showToken){var e=a.getCursor("from"),i=a.getCursor("to");if(e.line==i.line&&(!t.wordsOnly||function(t,e,i){{if(null!==t.getRange(e,i).match(/^\w+$/)){if(0<e.ch){var n={line:e.line,ch:e.ch-1},r=t.getRange(n,e);if(null===r.match(/\W/))return!1}if(i.ch<t.getLine(e.line).length){var n={line:i.line,ch:i.ch+1},r=t.getRange(i,n);if(null===r.match(/\W/))return!1}return!0}return!1}}(a,e,i))){var n=a.getRange(e,i).replace(/^\s+|\s+$/g,"");n.length>=t.minChars&&a.addOverlay(t.overlay=c(n,!1,t.style))}}else{for(var r=!0===t.showToken?/[\w$]/:t.showToken,o=a.getCursor(),l=a.getLine(o.line),h=o.ch,s=h;h&&r.test(l.charAt(h-1));)--h;for(;s<l.length&&r.test(l.charAt(s));)++s;h<s&&a.addOverlay(t.overlay=c(l.slice(h,s),r,t.style))}})}function c(n,r,o){return{token:function(t){if(t.match(n)&&(!r||(i=r,!((e=t).start&&i.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&i.test(e.string.charAt(e.pos))))))return o;var e,i;t.next(),t.skipTo(n.charAt(0))||t.skipToEnd()}}}r.defineOption("highlightSelectionMatches",!1,function(t,e,i){if(i&&i!=r.Init){var n=t.state.matchHighlighter.overlay;n&&t.removeOverlay(n),clearTimeout(t.state.matchHighlighter.timeout),t.state.matchHighlighter=null,t.off("cursorActivity",l)}e&&(t.state.matchHighlighter=new o(e),h(t),t.on("cursorActivity",l))})});