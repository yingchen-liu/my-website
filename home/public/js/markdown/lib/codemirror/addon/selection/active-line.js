!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(r){"use strict";var a="CodeMirror-activeline",s="CodeMirror-activeline-background";function c(e){for(var t=0;t<e.state.activeLines.length;t++)e.removeLineClass(e.state.activeLines[t],"wrap",a),e.removeLineClass(e.state.activeLines[t],"background",s)}function o(t,e){for(var n=[],i=0;i<e.length;i++){var r=e[i];if(r.empty()){var o=t.getLineHandleVisualStart(r.head.line);n[n.length-1]!=o&&n.push(o)}}(function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0})(t.state.activeLines,n)||t.operation(function(){c(t);for(var e=0;e<n.length;e++)t.addLineClass(n[e],"wrap",a),t.addLineClass(n[e],"background",s);t.state.activeLines=n})}function f(e,t){o(e,t.ranges)}r.defineOption("styleActiveLine",!1,function(e,t,n){var i=n&&n!=r.Init;t&&!i?(e.state.activeLines=[],o(e,e.listSelections()),e.on("beforeSelectionChange",f)):!t&&i&&(e.off("beforeSelectionChange",f),c(e),delete e.state.activeLines)})});