!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],t):t(CodeMirror)}(function(u){"use strict";u.defineMode("htmlmixed",function(t,e){var r=u.getMode(t,{name:"xml",htmlMode:!0,multilineTagIndentFactor:e.multilineTagIndentFactor,multilineTagIndentPastTag:e.multilineTagIndentPastTag}),s=u.getMode(t,"css"),i=[],a=e&&e.scriptTypes;if(i.push({matches:/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,mode:u.getMode(t,"javascript")}),a)for(var o=0;o<a.length;++o){var l=a[o];i.push({matches:l.matches,mode:l.mode&&u.getMode(t,l.mode)})}function n(t,e){var a=e.htmlState.tagName;a&&(a=a.toLowerCase());var o=r.token(t,e.htmlState);if("script"==a&&/\btag\b/.test(o)&&">"==t.current()){var l=t.string.slice(Math.max(0,t.pos-100),t.pos).match(/\btype\s*=\s*("[^"]+"|'[^']+'|\S+)[^<]*$/i);(l=l?l[1]:"")&&/[\"\']/.test(l.charAt(0))&&(l=l.slice(1,l.length-1));for(var n=0;n<i.length;++n){var c=i[n];if("string"==typeof c.matches?l==c.matches:c.matches.test(l)){c.mode&&(e.token=m,e.localMode=c.mode,e.localState=c.mode.startState&&c.mode.startState(r.indent(e.htmlState,"")));break}}}else"style"==a&&/\btag\b/.test(o)&&">"==t.current()&&(e.token=d,e.localMode=s,e.localState=s.startState(r.indent(e.htmlState,"")));return o}function c(t,e,a){var o=t.current(),l=o.search(e);return-1<l?t.backUp(o.length-l):o.match(/<\/?$/)&&(t.backUp(o.length),t.match(e,!1)||t.match(o)),a}function m(t,e){return t.match(/^<\/\s*script\s*>/i,!1)?(e.token=n,e.localState=e.localMode=null,null):c(t,/<\/\s*script\s*>/,e.localMode.token(t,e.localState))}function d(t,e){return t.match(/^<\/\s*style\s*>/i,!1)?(e.token=n,e.localState=e.localMode=null,null):c(t,/<\/\s*style\s*>/,s.token(t,e.localState))}return i.push({matches:/./,mode:u.getMode(t,"text/plain")}),{startState:function(){return{token:n,localMode:null,localState:null,htmlState:r.startState()}},copyState:function(t){if(t.localState)var e=u.copyState(t.localMode,t.localState);return{token:t.token,localMode:t.localMode,localState:e,htmlState:u.copyState(r,t.htmlState)}},token:function(t,e){return e.token(t,e)},indent:function(t,e){return!t.localMode||/^\s*<\//.test(e)?r.indent(t.htmlState,e):t.localMode.indent?t.localMode.indent(t.localState,e):u.Pass},innerMode:function(t){return{state:t.localState||t.htmlState,mode:t.localMode||r}}}},"xml","javascript","css"),u.defineMIME("text/html","htmlmixed")});