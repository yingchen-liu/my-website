!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("smarty",function(e){var l={rightDelimiter:"}",leftDelimiter:"{",smartyVersion:2};e.hasOwnProperty("leftDelimiter")&&(l.leftDelimiter=e.leftDelimiter),e.hasOwnProperty("rightDelimiter")&&(l.rightDelimiter=e.rightDelimiter),e.hasOwnProperty("smartyVersion")&&3===e.smartyVersion&&(l.smartyVersion=3);var f,u=["debug","extends","function","include","literal"],s={operatorChars:/[+\-*&%=<>!?]/,validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/},d=function(e,t){return f=t,e},n=function(e,t,r){return(t.tokenize=r)(e,t)},m={tokenizer:function(e,t){if(e.match(l.leftDelimiter,!0)){if(e.eat("*"))return n(e,t,m.inBlock("comment","*"+l.rightDelimiter));t.depth++;var r=e.eol(),i=/\s/.test(e.peek());return 3===l.smartyVersion&&"{"===l.leftDelimiter&&(r||i)?(t.depth--,null):(t.tokenize=m.smarty,f="startTag","tag")}return e.next(),null},smarty:function(e,t){if(e.match(l.rightDelimiter,!0))return 3===l.smartyVersion?(t.depth--,t.depth<=0&&(t.tokenize=m.tokenizer)):t.tokenize=m.tokenizer,d("tag",null);if(e.match(l.leftDelimiter,!0))return t.depth++,d("tag","startTag");var r=e.next();if("$"==r)return e.eatWhile(s.validIdentifier),d("variable-2","variable");if("|"==r)return d("operator","pipe");if("."==r)return d("operator","property");if(s.stringChar.test(r))return t.tokenize=m.inAttribute(r),d("string","string");if(s.operatorChars.test(r))return e.eatWhile(s.operatorChars),d("operator","operator");if("["==r||"]"==r)return d("bracket","bracket");if("("==r||")"==r)return d("bracket","operator");if(/\d/.test(r))return e.eatWhile(/\d/),d("number","number");if("variable"==t.last){if("@"==r)return e.eatWhile(s.validIdentifier),d("property","property");if("|"==r)return e.eatWhile(s.validIdentifier),d("qualifier","modifier")}else{if("pipe"==t.last)return e.eatWhile(s.validIdentifier),d("qualifier","modifier");if("whitespace"==t.last)return e.eatWhile(s.validIdentifier),d("attribute","modifier")}if("property"==t.last)return e.eatWhile(s.validIdentifier),d("property",null);if(/\s/.test(r))return f="whitespace",null;var i="";"/"!=r&&(i+=r);for(var n=null;n=e.eat(s.validIdentifier);)i+=n;for(var a=0,o=u.length;a<o;a++)if(u[a]==i)return d("keyword","keyword");return/\s/.test(r)?null:d("tag","tag")},inAttribute:function(n){return function(e,t){for(var r=null,i=null;!e.eol();){if(i=e.peek(),e.next()==n&&"\\"!==r){t.tokenize=m.smarty;break}r=i}return"string"}},inBlock:function(r,i){return function(e,t){for(;!e.eol();){if(e.match(i)){t.tokenize=m.tokenizer;break}e.next()}return r}}};return{startState:function(){return{tokenize:m.tokenizer,mode:"smarty",last:null,depth:0}},token:function(e,t){var r=t.tokenize(e,t);return t.last=f,r},electricChars:""}}),e.defineMIME("text/x-smarty","smarty")});