!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../htmlmixed/htmlmixed"],t):t(CodeMirror)}(function(c){"use strict";c.defineMode("htmlembedded",function(t,e){var n,i,o=e.scriptStartRegex||/^<%/i,r=e.scriptEndRegex||/^%>/i;function d(t,e){return t.match(o,!1)?(e.token=a,n.token(t,e.scriptState)):i.token(t,e.htmlState)}function a(t,e){return t.match(r,!1)?(e.token=d,i.token(t,e.htmlState)):n.token(t,e.scriptState)}return{startState:function(){return n=n||c.getMode(t,e.scriptingModeSpec),i=i||c.getMode(t,"htmlmixed"),{token:e.startOpen?a:d,htmlState:c.startState(i),scriptState:c.startState(n)}},token:function(t,e){return e.token(t,e)},indent:function(t,e){return t.token==d?i.indent(t.htmlState,e):n.indent?n.indent(t.scriptState,e):void 0},copyState:function(t){return{token:t.token,htmlState:c.copyState(i,t.htmlState),scriptState:c.copyState(n,t.scriptState)}},innerMode:function(t){return t.token==a?{state:t.scriptState,mode:n}:{state:t.htmlState,mode:i}}}},"htmlmixed"),c.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"}),c.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"}),c.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"}),c.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"})});